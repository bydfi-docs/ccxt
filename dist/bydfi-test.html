<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="text/javascript" src="./ccxt.browser.js"></script>
    <script>
      // æ·»åŠ å»¶è¿Ÿå‡½æ•°
      function delay() {
        return new Promise(resolve => setTimeout(resolve, 500));
      }

      async function update() {
        const updates = document.querySelector('#updates');
        
        const bydfi = new ccxt.bydfi();
        window.bydfi = bydfi;
        // const result = await bydfi.convertPositionSide('DELIVERY', 'W001', 'ONEWAY');
        // const result = await bydfi.createOrder('BTC/USDT:USDT', 'limit', 'buy', 133, 105000, {
        //   'wallet': 'W001',
        //   'quantity': 0.0001,
        //   'positionSide': 'LONG',
        //   'timeInForce': 'GTC',
        // });
        // const result = await bydfi.setLeverage(10, 'BTC/USDT:USDT', {
        //   'wallet': 'W001',
        // });
        // const result = await bydfi.setBatchLeverage(10, ['BTC/USDT:USDT', 'ETH/USDT:USDT'], 'W001');
        // const result = await bydfi.createOrder('BTC/USDT:USDT', 'limit', 'buy', 123, 105000, {
        //   'wallet': 'W001',
        //   'positionSide': 'BOTH',
        //   'timeInForce': 'GTC',
        // });
        const result = await bydfi.cancelOrder('1147854291534245888', 'BTC/USDT:USDT', {
          'wallet': 'W001',
        });
        console.log('result:', result);
        // æµ‹è¯•æ‰€æœ‰æ–¹æ³•
        // try {
        //   // 1. æµ‹è¯• fetchMarkets - è·å–å¸‚åœºä¿¡æ¯
        //   console.log('=== æµ‹è¯• fetchMarkets ===');
        //   const markets = await bydfi.fetchMarkets();
        //   console.log('å¸‚åœºä¿¡æ¯:', markets);
        //   addUpdate('âœ… fetchMarkets æˆåŠŸ - è·å–åˆ° ' + markets.length + ' ä¸ªå¸‚åœº');
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // 2. æµ‹è¯• fetchSwapTicker - è·å–24å°æ—¶ä»·æ ¼ç»Ÿè®¡
        //   console.log('=== æµ‹è¯• fetchSwapTicker ===');
          
        //   // 2.1 æµ‹è¯•è·å–å•ä¸ªå¸å¯¹çš„ticker
        //   console.log('--- æµ‹è¯•è·å–å•ä¸ªå¸å¯¹ticker ---');
        //   const ticker = await bydfi.fetchSwapTicker('BTC/USDT:USDT');
        //   console.log('BTC/USDT 24å°æ—¶ä»·æ ¼ç»Ÿè®¡:', ticker);
        //   addUpdate('âœ… fetchSwapTicker(BTC/USDT:USDT) æˆåŠŸ - æœ€æ–°ä»·æ ¼: ' + ticker.last);
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // // 2.2 æµ‹è¯•è·å–æ‰€æœ‰å¸å¯¹çš„tickeræ•°ç»„
        //   // console.log('--- æµ‹è¯•è·å–æ‰€æœ‰å¸å¯¹ticker ---');
        //   // const allTickers = await bydfi.fetchSwapTicker();
        //   // console.log('æ‰€æœ‰å¸å¯¹24å°æ—¶ä»·æ ¼ç»Ÿè®¡:', allTickers);
        //   // addUpdate('âœ… fetchSwapTicker() æˆåŠŸ - è·å–åˆ° ' + allTickers.length + ' ä¸ªå¸å¯¹çš„tickeræ•°æ®');
          
        //   // // æ˜¾ç¤ºå‰å‡ ä¸ªå¸å¯¹çš„ä»·æ ¼ä¿¡æ¯
        //   // const firstFewTickers = allTickers.slice(0, 3);
        //   // firstFewTickers.forEach((t, index) => {
        //   //   addUpdate('   ' + (index + 1) + '. ' + t.symbol + ' - æœ€æ–°ä»·æ ¼: ' + t.last);
        //   // });
          
        //   // 3. æµ‹è¯• fetchSwapFundingRate - è·å–èµ„é‡‘è´¹ç‡
        //   console.log('=== æµ‹è¯• fetchFundingRate ===');
        //   const fundingRate = await bydfi.fetchFundingRate('BTC/USDT:USDT');
        //   console.log('BTC/USDT èµ„é‡‘è´¹ç‡:', fundingRate);
        //   addUpdate('âœ… fetchFundingRate æˆåŠŸ - èµ„é‡‘è´¹ç‡: ' + fundingRate.fundingRate);
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
          // 4. æµ‹è¯• fetchSwapFundingHistory - è·å–èµ„é‡‘å†å²
          // console.log('=== æµ‹è¯• fetchSwapFundingHistory ===');
          // const fundingHistory = await bydfi.fetchSwapFundingHistory();
          // console.log('BTC/USDT èµ„é‡‘å†å²:', fundingHistory);
          // addUpdate('âœ… fetchSwapFundingHistory æˆåŠŸ - è·å–åˆ° ' + fundingHistory.length + ' æ¡è®°å½•');
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // 5. æµ‹è¯• fetchSwapMarketDepth - è·å–å¸‚åœºæ·±åº¦
        //   console.log('=== æµ‹è¯• fetchSwapMarketDepth ===');
        //   const marketDepth = await bydfi.fetchSwapMarketDepth('BTC/USDT:USDT', 10);
        //   console.log('BTC/USDT å¸‚åœºæ·±åº¦:', marketDepth);
        //   addUpdate('âœ… fetchSwapMarketDepth æˆåŠŸ - ä¹°å•: ' + marketDepth.bids.length + ' æ¡, å–å•: ' + marketDepth.asks.length + ' æ¡');
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // 6. æµ‹è¯• fetchTrades - è·å–äº¤æ˜“è®°å½•
        //   console.log('=== æµ‹è¯• fetchTrades ===');
        //   const trades = await bydfi.fetchTrades('BTC/USDT:USDT', undefined, 10);
        //   console.log('BTC/USDT äº¤æ˜“è®°å½•:', trades);
        //   addUpdate('âœ… fetchTrades æˆåŠŸ - è·å–åˆ° ' + trades.length + ' æ¡äº¤æ˜“è®°å½•');
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // 7. æµ‹è¯• fetchOHLCV - è·å–Kçº¿æ•°æ®
        //   console.log('=== æµ‹è¯• fetchOHLCV ===');
        //   const ohlcv = await bydfi.fetchOHLCV('BTC/USDT:USDT', '1m', 1750239564323, 10, {
        //     'endTime': 1750325967923
        //   });
        //   console.log('BTC/USDT Kçº¿æ•°æ®:', ohlcv);
        //   addUpdate('âœ… fetchOHLCV æˆåŠŸ - è·å–åˆ° ' + ohlcv.length + ' æ¡Kçº¿æ•°æ®');
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // 8. æµ‹è¯• fetchSwapLastPrice - è·å–æœ€æ–°ä»·æ ¼
        //   console.log('=== æµ‹è¯• fetchSwapLastPrice ===');
        //   const lastPrices = await bydfi.fetchSwapLastPrice('BTC/USDT:USDT');
        //   console.log('BTC/USDT æœ€æ–°ä»·æ ¼:', lastPrices);
        //   addUpdate('âœ… fetchSwapLastPrice æˆåŠŸ - æœ€æ–°ä»·æ ¼: ' + lastPrices[0].price);
          
        //   await delay(); // å»¶è¿Ÿ500ms
          
        //   // 9. æµ‹è¯• fetchMarkPrice - è·å–æ ‡è®°ä»·æ ¼
        //   console.log('=== æµ‹è¯• fetchMarkPrice ===');
        //   const markPrice = await bydfi.fetchMarkPrice('BTC/USDT:USDT');
        //   console.log('BTC/USDT æ ‡è®°ä»·æ ¼:', markPrice);
        //   addUpdate('âœ… fetchMarkPrice æˆåŠŸ - æ ‡è®°ä»·æ ¼: ' + markPrice.markPrice);
          
        //   addUpdate('ğŸ‰ æ‰€æœ‰æ–¹æ³•æµ‹è¯•å®Œæˆï¼');
          
        // } catch (error) {
        //   console.error('æµ‹è¯•å‡ºé”™:', error);
        //   addUpdate('âŒ æµ‹è¯•å¤±è´¥: ' + error.message);
        // }
      }
      
      function addUpdate(message) {
        const updates = document.querySelector('#updates');
        const li = document.createElement('li');
        li.textContent = message;
        updates.appendChild(li);
      }
    </script>
  </head>

  <body onload="update()">
    <h3>Bydfi API æ–¹æ³•æµ‹è¯•</h3>
    <p>æ­£åœ¨æµ‹è¯• bydfi.ts ä¸­å®ç°çš„æ‰€æœ‰æ–¹æ³•...</p>
    <ul id="updates" style="color: black; font-family: monospace; font-size: 14px;"></ul>
  </body>
</html>
